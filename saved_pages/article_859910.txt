<!DOCTYPE html>

<html lang="ru">
<head>
<title>Версионирование эндпоинтов — это просто / Хабр</title>
</head>
<body>
<div id="mount"><div data-async-called="true" id="app"><div class="tm-layout__wrapper"><!--[--><!-- --><div></div><!-- --><header class="tm-header" data-test-id="header"><div class="tm-page-width"><!--[--><div class="tm-header__container"><!-- --><span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_hl-ru tm-header__logo" href="/ru/"><svg class="tm-svg-img tm-header__icon" height="16" width="16"><title>Хабр</title><use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a><span class="tm-header__beta-sign" style="display:none;">β</span></span><!--[--><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><!--[--><button class="tm-header__dropdown-toggle"><svg class="tm-svg-img tm-header__icon tm-header__icon_dropdown" height="16" width="16"><title>Открыть список</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#arrow-down"></use></svg></button><!--]--></div><!-- --></div><a class="tm-header__become-author-btn" href="/ru/sandbox/start/">Как стать автором</a><div class="tm-feature tm-feature tm-feature_variant-inline tm-header__feature"><!-- --></div><!-- --><!--]--><!-- --></div><!--]--></div></header><div class="tm-layout"><div class="tm-page-progress-bar"></div><div class="tm-base-layout__header_is-sticky tm-base-layout__header" data-menu-sticky="true"><div class="tm-page-width"><!--[--><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/feed/">Моя лента</a><!--]--><!--[--><a class="tm-main-menu__item" href="/ru/articles/">Все потоки</a><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/develop/">Разработка</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/admin/">Администрирование</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/design/">Дизайн</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/management/">Менеджмент</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/marketing/">Маркетинг</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/popsci/">Научпоп</a><!--]--><!--]--></nav></div></div><div class="tm-header-user-menu tm-base-layout__user-menu"><a class="tm-header-user-menu__item tm-header-user-menu__search" data-test-id="search-button" href="/ru/search/"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark" height="24" width="24"><title>Поиск</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#search"></use></svg></a><!-- --><!-- --><div class="tm-header-user-menu__item tm-header-user-menu__write"><div><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_write tm-header-user-menu__icon_dark" height="24" width="24"><title>Написать публикацию</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#write"></use></svg></div><!-- --></div><!--[--><div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="user-menu-settings"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark" height="24" width="24"><title>Настройки</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#page-settings"></use></svg></button></div><a class="tm-header-user-menu__item" href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/companies/spring_aio/articles/859910/&amp;hl=ru" rel="nofollow"><!--[--><button class="btn btn_solid btn_small tm-header-user-menu__login" type="button"><!--[-->Войти<!--]--></button><!--]--></a><!--]--><!-- --><!--teleport start--><!--teleport end--><!-- --></div></div><!--]--></div></div><!-- --><div class="tm-page-width"><!--[--><!--]--></div><main class="tm-layout__container"><div class="tm-page" companyname="spring_aio" data-async-called="true" hl="ru" style="--0c809c5a:16px;--a086013e:100%;--7c457026:0;"><div class="tm-page-width"><!--[--><div class="tm-page__header"><!--[--><!--]--></div><div class="tm-page__wrapper"><div class="tm-page__main_has-sidebar tm-page__main"><div class="pull-down"><!-- --><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__icon pull-down__arrow" height="24" width="24"><title>Обновить</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#pull-arrow"></use></svg></div></div><!--[--><!--[--><div class="tm-article-presenter"><!--[--><!--[--><!-- --><div class="tm-company-profile-card tm-company-article__profile-card"><div class="tm-company-card tm-company-profile-card__info"><div class="tm-company-card__header"><a class="tm-company-card__avatar" href="/ru/companies/spring_aio/profile/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="48" src="//habrastorage.org/getpro/habr/company/8f1/91a/458/8f191a4584b8fab12d15af23e447a1d5.png" width="48"/></div></a><!--[--><!-- --><div class="tm-counter-container tm-company-card__rating"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!-- --><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">77.73</span></span><!--]--></div><!-- --></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Рейтинг</span><!--]--></div></div><!-- --><!--]--></div><div class="tm-company-card__info"><a class="tm-company-card__name" href="/ru/companies/spring_aio/profile/"><span>Spring АйО</span></a><!-- --></div></div><div class="tm-company-profile-card__buttons"><div class="tm-button-follow tm-company-profile-card__button tm-company-profile-card__button_follow"><!-- --><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div><!-- --><!-- --><!-- --></div></div><!-- --><!--]--><!--]--><div class="tm-article-presenter__body" data-test-id="article-body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><!--[--><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><!--[--><div class="tm-article-presenter__header"><!--[--><!--]--><div class="tm-article-snippet tm-article-snippet tm-article-presenter__snippet"><!--[--><!--]--><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a class="tm-user-info__userpic" data-test-id="user-info-pic" href="/ru/users/spring_aio/" title="spring_aio"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/8e0/5e8/a1c/8e05e8a1c5fd4560f661efb2cb00e77e.png" width="24"/></div></a><span class="tm-user-info__user tm-user-info__user_appearance-default" data-test-id="user-info-description"><a class="tm-user-info__username" href="/ru/users/spring_aio/">spring_aio <!-- --></a><!--[--><span class="tm-article-datetime-published"><time datetime="2024-11-20T13:19:57.000Z" title="2024-11-20, 16:19">20  ноя  2024 в 16:19</time></span><!--]--></span></span></div><!-- --></div><h1 class="tm-title tm-title_h1" data-test-id="articleTitle" lang="ru"><span>Версионирование эндпоинтов — это просто</span></h1><div class="tm-article-snippet__stats" data-test-id="articleStats"><div class="tm-article-complexity tm-article-complexity_complexity-low"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Уровень сложности</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#complexity-low"></use></svg></span><span class="tm-article-complexity__label">Простой</span></div><div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Время на прочтение</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#clock"></use></svg></span><span class="tm-article-reading-time__label">17 мин</span></div><span class="tm-icon-counter tm-data-icons__item"><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Количество просмотров</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-views"></use></svg><span class="tm-icon-counter__value" title="10829">11K</span></span></div><div class="tm-publication-hubs__container" data-test-id="articleHubsList"><div class="tm-publication-hubs"><!--[--><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/companies/spring_aio/articles/"><!--[--><span>Блог компании Spring АйО</span><!-- --><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/programming/"><!--[--><span>Программирование</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/java/"><!--[--><span>Java</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/kotlin/"><!--[--><span>Kotlin</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/api/"><!--[--><span>API</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><!--]--></div></div><div class="tm-article-labels" data-test-id="articleLabels"><div class="tm-article-labels__container"><div class="tm-publication-label tm-publication-label_variant-review"><span>Обзор</span></div><!--[--><!--]--></div></div><!-- --><!-- --></div></div><!--[--><!-- --><div class="tm-article-body" data-gallery-root="" lang="ru"><div><!--[--><!--]--></div><div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>Команда <a href="https://t.me/+QmrKn0wA8CdkNjAy"><u>Spring АйО</u></a> перевела и адаптировала доклад "<a href="https://www.youtube.com/watch?v=5U0Bx8lMQlk"><u>Endpoint versioning made simple</u></a>" Бауке Найхаус (Bouke Nijhuis) с последнего Devoxx Belgium. </p><p>В докладе автор объясняет, зачем нужно версионировать API, и подробно сравнивает различные подходы к реализации этой задачи.</p><hr/><h3>Что такое версионирование эндпоинтов?</h3><p>Начать следует с объяснения того, что такое версионирование эндпоинтов. Эндпоинты могут иметь несколько версий. Другими словами, взаимодействуя с сервисом, надо указывать версию эндпоинта при каждом его вызове. Из многочисленных способов сделать это мы приведем лишь несколько примеров, отражающих наиболее распространенные варианты. Вы можете поставить версию в середине между API и ресурсом:</p><p><code>api/v1/resource</code></p><p>Вы также можете указать ее в конце как параметр запроса:</p><p><code>/api/resource?version=1</code></p><p>Другой вопрос, требующий прояснения — это зачем нам вообще нужно версионирование эндпоинтов. И ответ на него следующий: версионирование эндпоинтов обеспечивает дополнительную гибкость в контракте между фронтендом и бэкендом или потребителями и производителями (consumers/producers). Наилучший способ объяснить, почему оно нам необходимо — это объяснить, что случится, если у нас его не будет. </p><p>Без версионирования эндпоинтов выпуск релизов становится опасным. Если вы не используете версионирование эндпоинтов, и у вас присутствуют фронтенд и бэкенд, и в программном продукте произошли радикальные изменения, относящиеся к контракту между этими двумя компонентами, вы должны запустить их точно в один и тот же момент времени. А это довольно сложно. В случае неудачного деплоймента одного из компонентов отсутствие версионирования эндпоинтов может привести к даунтайму всей системы, который продлится от нескольких минут до нескольких часов.</p><p>Поэтому мы делаем версионирование эндпоинтов.</p><p>Оно позволяет использовать так называемую “разницу на шаг” (pace difference). Это означает, что можно подготовить бэкенд, добавить новые версии к бэкенду и затем поднять этот новый бэкенд, и он будет содержать две версии: старую и новую; при этом фронтэнд все еще будет общаться со старой версией эндпоинта. В более поздний момент времени произойдет релиз нового фронтенда, и он будет общаться с новой версией эндпоинта на бэкенде. Это положит конец необходимости релизить оба компонента в одно и то же время.</p><p>Версионирование эндпоинтов также экономит множество шагов и спасает нас от многочисленных рисков. Однако оно создает и некоторые дополнительные сложности, о чем мы поговорим далее.</p><h3>В чем основная сложность традиционного подхода?</h3><p>Давайте посмотрим на то, что происходит при разработке нового проекта, который  использует версионированные эндпоинты.</p><p>В процессе разработки команда регулярно добавляла новые ресурсы и их версии. В какой-то момент потребителям стало трудно уследить за всеми версиями. Проиллюстрировать это можно простым примером:</p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/56a/1d7/d17/56a1d7d17ff9cb2d323f3dfefef00192.png" height="602" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/56a/1d7/d17/56a1d7d17ff9cb2d323f3dfefef00192.png" width="1600"/></figure><p>У нас есть три ресурса: <code>Customer</code> (клиент), <code>Product</code> (товар) и <code>Order</code> (заказ).  На начальной стадии развития проекта у всех ресурсов есть по одноиу эндпоинту, и, соответственно, версия этого  эндпоинта — <code>v1</code>, как показано на рисунке.  Чтобы создать один <code>order</code>, необходимы <code>customer</code> и <code>product</code>, и в скобках написано (c1, p1), что означает, что вам нужен <code>customer</code> версии <code>v1</code> и <code>product</code> версии <code>v1</code>, чтобы создать <code>order</code> версии <code>v1</code>. Пока все просто. Но если добавить новые версии, это будет выглядеть вот так: </p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/b03/11a/ba9/b0311aba9c94d3c70e526c85513a84c5.png" height="742" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/b03/11a/ba9/b0311aba9c94d3c70e526c85513a84c5.png" width="1600"/></figure><p>Новые версии обозначены розовым цветом, и справа под orders вы видите, что вам уже нужны <code>orders</code> версии <code>v2</code>, которые требуют <code>customers</code> версии <code>v2</code>, и затем <code>v3</code> уже нуждается в двух видах входящей информации, и с добавлением большего количества версий ситуация все больше усложняется. И будет еще хуже, если добавить еще один ресурс. </p><p>После долгих раздумий о возможных решениях данной проблемы родилась идея глобального версионирования. О ней и поговорим в данной статье далее. </p><p>Традиционный подход к версионированию предполагает, что существует номер версии для каждого ресурса и каждого метода. Например, если вы хотите применить метод <code>GET</code> к ресурсу <code>Car</code>, вы используете версию 5, если вы хотите применить метод <code>PUT</code> к ресурсу <code>Car</code>, вам нужна версия 8, а если вы хотите применить метод <code>POST</code> к ресурсу <code>Car</code>, вы используете версию 11. При глобальном версионировании предполагается,что один номер версии будет применяться ко всему API.</p><p>Итак, каждый раз, когда вы меняете что-то в контракте где-то в вашем API, вы можете увеличить номер версии на 1. Возможно, это прозвучит как реально странная идея, поэтому мы попробуем сделать ее более понятной далее. </p><h3>Требования к предлагаемому решению</h3><p>Помимо самой идеи глобального версионирования, автор доклада также формулирует несколько обязательных требований к ее практической реализации. Соответственно, описывая предложенные опции по реализации глобального версионирования. Мы каждый раз будем проверять их на выполнение приведенных требований. Естественно, в идеале все требования должны выполняться.   </p><ul><li><p>Итак, первое требование состоит в том, что <strong>потребители должны иметь возможность использовать один и тот же номер версии для всех эндпоинтов</strong>, именно в этом состоит вся идея глобального версионирования. Заметьте, что используется формулировка “иметь возможность”, но при этом подчеркивается, что потребитель не обязан так делать. Вы все еще можете использовать специфические эндпоинты для метода со специфической версией, например, если там есть баг или у вас есть какая-то другая реальная причина. Однако, без достаточно веской причины так делать не рекомендуется, так как это подрывает базовую идею глобального версионирования.</p></li></ul><ul><li><p>Во-вторых, <strong>Минимум дополнительного кода</strong>. Конечно, добавление новой функциональности потребует несколько лишних строк кода, но важно стремиться к тому, чтобы их было как можно меньше.</p></li></ul><ul><li><p>И в-третьих, <strong>добавление любого ресурса, версии или метода должно минимально влиять на остальную кодовую базу</strong>, за пределами новой функциональности. Добавление новой функциональности неизбежно влечёт за собой написание нового кода. Однако важно, чтобы это минимально влияло на существующую кодовую базу. В идеале изменения не должны затрагивать другие части системы, но на практике добиться полного отсутствия влияния практически невозможно.</p></li></ul><h2>Отправная точка</h2><p>Для первой практической демонстрации было использовано базовое приложение на Spring Boot, со следующим контроллером:</p><p><em>Примечание: код, используемый в данной статье, можно найти у автора доклада на </em><a href="https://github.com/BoukeNijhuis/dynamic-version-url"><em><u>GitHub</u></em></a><em>.</em></p><pre><code class="java">package io.github.boukenijhuis.dynamicversionurl;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class MyController {

   @GetMapping("/v1/a")
   public String a1() {
       return "a1";
   }

   @GetMapping("/v1/b")
   public String b1() {
       return "b1";
   }
}</code></pre><p>Что мы здесь видим? В приложении присутствуют два эндпоинта, и они оба используют <code>@GetMapping</code>. Есть ресурс <code>a</code>, который находится в версии 1, и он всегда возвращает <code>a1</code>.  Есть ресурс <code>b1</code>, аналогичный <code>a1</code>.</p><p>Каждый раз при добавлении эндпоинтов к коду будет меняться эндпоинт <code>a</code>, так что это будет <code>a</code> версии 2, который возвращает <code>a2</code>, затем это будет эндпоинт версии 3, который возвращает <code>a3</code>. Однако, мы используем глобальное версионирование. Поэтому каждый раз, когда что-то добавляется к ресурсу <code>a</code>, номер версии ресурса <code>b</code> тоже должен увеличиваться. Поэтому тут вы тоже увидите эндпоинты версии 2 и 3 для ресурса, но они будут всегда возвращать <code>b1</code>.</p><p>Если запустить тесты, проверяющие корректную работу эндпоинтов, то тесты для <code>a1</code> и <code>b1</code> пройдут, что логично, а вот тесты для <code>a2</code> и <code>b2</code> не пройдут, потому что эти эндпоинты пока не реализованы.</p><pre><code class="java">package io.github.boukenijhuis.dynamicversionurl;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.test.web.servlet.MockMvc;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

@WebMvcTest(MyController.class)
class MyControllerTest {

   @Autowired
   MockMvc mockMvc;

   @Test
   void a1() throws Exception {
       testEndpoint("/v1/a", "a1");
   }

   @Test
   void b1() throws Exception {
       testEndpoint("/v1/b", "b1");
   }

   @Test
   void a2() throws Exception {
       testEndpoint("/v2/a", "a2");
   }

   @Test
   void b2() throws Exception {
       testEndpoint("/v2/b", "b1");
   }

   private void testEndpoint(String path, String response) throws Exception {
       mockMvc.perform(get(path))
               .andExpect(status().isOk())
               .andExpect(content().string(response))
               .andReturn();
   }
}</code></pre><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/a70/7fe/68c/a707fe68ccdb474b2b30b0fa90d1dfa8.png" height="1080" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/a70/7fe/68c/a707fe68ccdb474b2b30b0fa90d1dfa8.png" width="1218"/></figure><p>Теперь добавим эндпоинт второй версии. </p><pre><code class="java">package io.github.boukenijhuis.dynamicversionurl;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class MyController {

   @GetMapping("/v1/a")
   public String a1() {
       return "a1";
   }

   @GetMapping("/v2/a")
   public String a2() {
       return "a2";
   }

   @GetMapping("/v1/b")
   public String b1() {
       return "b1";
   }
}</code></pre><p>Итак, у нас теперь есть эндпоинт версии <code>v2</code> для ресурса a. На этом этапе пройдут три теста, и не пройдет только тест для <code>b2</code>, опять таки потому что этот эндпоинт все еще не реализован.</p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/bcd/4e1/9ba/bcd4e19ba1929ffbf13f6ca03bde2739.png" height="992" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/bcd/4e1/9ba/bcd4e19ba1929ffbf13f6ca03bde2739.png" width="1130"/></figure><p>Но мы уже можем проверить, насколько данное решение соответствует предъявляемым требованиям.</p><ul><li><p><strong>Единая версия для всех эндпоинтов</strong>. Сейчас это условие не выполняется. Запрос к эндпоинту <code>v2</code> для ресурса <code>b</code> не работает, что мы видели в тестах.</p></li></ul><ul><li><p><strong>Минимум дополнительного кода</strong> — Для реализации механизма не потребовалось писать дополнительный код. Мы еще не добавили сам механизм, поэтому этот пункт зеленый.</p></li></ul><ul><li><p><strong>Минимальное влияние на кодовую базу.</strong> Добавление нового ресурса, версии или метода не должно сильно влиять на кодовую базу. В данном случае был добавлен метод <code>a2</code> для реализации эндпоинта, но другие части кода это не затронуло. Следовательно, этот пункт тоже зеленый. </p></li></ul><div><div class="table"><table><tbody><tr><td colspan="2"><p align="left">Требования к решению</p></td></tr><tr><td><p align="left">Единая версия для всех эндпоинтов.</p></td><td><p align="left">🔴</p></td></tr><tr><td><p align="left">Минимум дополнительного кода.</p></td><td><p align="left">🟢</p></td></tr><tr><td><p align="left">Минимальное влияние на кодовую базу.</p></td><td><p align="left">🟢</p></td></tr></tbody></table></div></div><p>На первый взгляд, получить два зеленых кружка и один красный  — это очень хорошо, но, естественно, самый важный пункт для нас — первый. Мы хотим использовать один номер версии для всех эндпоинтов, так что нам надо еще поработать над нашим кодом.</p><p>Давайте перейдем к первому возможному решению, которое приходит в голову, самому простому и очевидному. Мы вводим специальные переменные для обозначения пути к эндпоинту и оператор <code>switch</code>:</p><pre><code class="java">@RestController
public class MyController {

  @GetMapping("/v{version}/a")
  public String a (@PathVariable("version") int version){
     return switch (version) {
      	   case 1 -&gt; a1();
         default -&gt; a2();
     };
  }

   public String a1() {
       return "a1";
   }

   public String a2() {
       return "a2";
   }
}</code></pre><p>Итак, каждый раз, когда вы просите версию 1 ресурса <code>a</code>, вы получаете <code>a1</code>, и каждый раз, когда вы просите что-то другое, например, <code>v2</code>, <code>v3</code>, вы получаете <code>a2</code>. Это не совсем правильно, но в дальнейшем будут показаны более удачные решения. Нам также больше не нужен вот этот фрагмент кода: </p><p>Что-то похожее мы можем сделать и для эндпоинтов <code>b</code></p><pre><code class="java">@GetMapping("/v{version}/b")
public String b(@PathVariable("version") int version) {
   return switch (version) {
       default -&gt; b1();
   };
}

public String b1() {
   return "b1";
}</code></pre><p>Здесь только <code>b1</code>, поэтому мы делаем его <code>default</code>. Если мы сейчас прогоним тесты, то все тесты станут зелеными. </p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/312/855/2f8/3128552f84e0a8341cf989f58d471b10.png" height="1110" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/312/855/2f8/3128552f84e0a8341cf989f58d471b10.png" width="1250"/></figure><p>Что это означает? Мы можем вызывать версию 1 от <code>a</code>, получать <code>a1</code>. Мы можем вызывать  версию 2 от <code>a</code>, она возвращает <code>a2</code>, мы можем вызывать версии 1 и 2 от <code>b</code>, и они обе вернут <code>b1</code>. </p><p>Итак, давайте проверим это решение на соответствие вышеупомянутым требованиям. </p><ul><li><p><strong>Единая версия для всех эндпоинтов</strong>. Пользователи могут использовать одну версию для всех эндпоинтов, и это действительно работает. При тестировании версии <code>v2</code> для эндпоинтов <code>a</code> и <code>b</code>, оба корректно функционировали. Фактически, решение поддерживает любые номера версий: 3, 4, 5 и так далее.</p></li></ul><ul><li><p><strong>Минимум дополнительного кода.</strong> Оценим объем изменений. Для реализации механизма пришлось добавить два новых метода с операторами <code>switch</code>. Это ощутимое усложнение, поэтому вместо "зеленого" кружка, ставим "красный".</p></li></ul><ul><li><p><strong>Минимальное влияние на кодовую базу</strong>. Теперь проверим, как добавление новой версии повлияет на систему. Попробуем добавить версию <code>a3</code> и оценим результат. Если вы вводите новую функциональность, вам неизбежно потребуется создать этот новый метод, но теперь добавляется дополнительная работа. Надо переделать <code>default</code> на <code>case</code> 2 и добавить <code>default</code> для <code>a3</code>:</p></li></ul><pre><code class="java">@GetMapping("/v{version}/a")
public String a(@PathVariable("version") int version) {
   return switch (version) {
       case 1 -&gt; a1();
       case 2 -&gt; a2();
       default -&gt; a3();
   };
}</code></pre><p>На этом этапе надо подключить тесты для <code>v3</code> <code>a</code> и <code>v3</code> <code>b,</code> и прогнать все шесть тестов.</p><pre><code class="java">package io.github.boukenijhuis.dynamicversionurl;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.test.web.servlet.MockMvc;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

@WebMvcTest(MyController.class)
class MyControllerTest {

   @Autowired
   MockMvc mockMvc;

   @Test
   void a1() throws Exception {
       testEndpoint("/v1/a", "a1");
   }

   @Test
   void b1() throws Exception {
       testEndpoint("/v1/b", "b1");
   }

   @Test
   void a2() throws Exception {
       testEndpoint("/v2/a", "a2");
   }

   @Test
   void b2() throws Exception {
       testEndpoint("/v2/b", "b1");
   }

   @Test
   void a3() throws Exception {
       testEndpoint("/v3/a", "a3");
   }

   @Test
   void b3() throws Exception {
       testEndpoint("/v3/b", "b1");
   }

   private void testEndpoint(String path, String response) throws Exception {
       mockMvc.perform(get(path))
               .andExpect(status().isOk())
               .andExpect(content().string(response))
               .andReturn();
   }
}</code></pre><p>Все шесть тестов будут зелеными.</p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/a53/2ce/f7d/a532cef7db242f5e0bbf283b6d61dc9c.png" height="1176" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/a53/2ce/f7d/a532cef7db242f5e0bbf283b6d61dc9c.png" width="1280"/></figure><p>Итак, мы говорим о пункте три, <strong>“Минимальное влияние на кодовую базу”</strong>. Это вроде бы верно, поскольку <code>b</code>-эндпоинт продолжил работать, и мы не трогали  <code>b</code>-эндпоинт, просто назвали его <code>v3</code>, потому что у нас есть <code>switch</code> с <code>default</code> для него. Будем считать, что этот пункт требований выполнен частично, и поставим напротив него оранжевый кружок.  </p><div><div class="table"><table><tbody><tr><td colspan="2"><p align="left">Требования к решению</p></td></tr><tr><td><p align="left">Единая версия для всех эндпоинтов.</p></td><td><p align="left">🔴➡️🟢</p></td></tr><tr><td><p align="left">Минимум дополнительного кода.</p></td><td><p align="left">🟢➡️🔴</p></td></tr><tr><td><p align="left">Минимальное влияние на кодовую базу.</p></td><td><p align="left">🟢➡️🟠</p></td></tr></tbody></table></div></div><p>Итак, один зеленый, один красный, один оранжевый. Это более-менее нормально, но можно сделать намного лучше. </p><p>Давайте перейдем к лучшему решению.</p><h3>Лучшее решение</h3><p>И лучшим решением будет ввести библиотеку. Бауке Найхаус, автор идеи глобального версионирования, предлагает решать эту проблему, используя библиотеку, которую он создал в процессе работы над максимально элегантным решением, при котором все три кружочка стали бы зелеными. Давайте посмотрим на пример того, как ее использование может улучшить положение вещей. </p><p>Вернемся к первоначальной версии кода, в которой присутствовали только <code>v1</code> <code>a</code> и <code>v1</code> <code>b</code>. </p><pre><code class="java">package nl.boukenijhuis.endpointversioning;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController 
public class Controller {
  @GetMapping("/v1/a")
  public String a1() {
    return "al";
  }
  
  @GetMapping("/v1/b") 
  public String b1() {
    return "b1";
  }
}</code></pre><p>Итак, библиотека. Давайте перейдем к файлу pom.xml и добавим такую зависимость:</p><pre><code class="xml">&lt;dependency&gt;
	&lt;groupId&gt;io.github.boukenijhuis&lt;/groupId&gt;
	&lt;artifactId&gt;dynamic-version-url&lt;/artifactId&gt;
	&lt;version&gt;0.0.9&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p>Добавление библиотеки дает нам доступ к новой аннотации под названием <code>@GetVersionMapping</code>.</p><pre><code class="java">package nl.boukenijhuis.endpointversioning;

import io.github.boukenijhuis.dynamicversionurl.GetVersionMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController 
public class Controller {
  
  @GetVersionMapping("/v1/a")
  public String a1() {
    return "al";
  }
  
  @GetMapping("/v1/b") 
  public String b1() {
    return "b1";
  }
}</code></pre><p>Эта аннотация предназначена для метода <code>GET</code>, но есть аналогичные аннотации для всех других методов. Благодаря этой аннотации вы можете отделить вашу информацию о версионировании. Вы можете написать:</p><pre><code class="java">@GetVersionMapping(value ="/a", version = 1)</code></pre><p>Если вы сделаете это, вам больше не нужен кусок <code>/v1</code> в строке значения пути к эндпоинту. Давайте сделаем то же самое для эндпоинта <code>b</code>.  По итогу должен получиться следующий код:</p><pre><code class="java">package nl.boukenijhuis.endpointversioning;

import io.github.boukenijhuis.dynamicversionurl.GetVersionMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController 
public class Controller {
  
  @GetVersionMapping(value ="/a", version = 1)
  public String a1() {
    return "al";
  }
  
  @GetVersionMapping(value ="/b", version = 1)
  public String b1() {
    return "b1";
  }
}</code></pre><p>Если прогнать тесты сейчас, они упадут, потому что появилась новая аннотация, но нам нужен кусочек кода, который что-то делает с этими аннотациями.</p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/9a4/ae8/184/9a4ae818463fbbc19138ec3272d46e17.png" height="1088" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/9a4/ae8/184/9a4ae818463fbbc19138ec3272d46e17.png" width="1192"/></figure><p>Этот код будет представлять собой Spring Boot конфигурацию, и мы поместим ее в новый класс под названием <code>WebMvcConfig</code>.</p><p>Требуемый код выглядит следующим образом:</p><pre><code class="java">package nl.boukenijhuis.endpointversioning;

import io.github.boukenijhuis.dynamicversionurl.ApiVersionRequestMappingHandLerMapping;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.DelegatingWebMvcConfiguration;
import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;

@Configuration
public class WebMvcConfig extends DelegatingWebMvcConfiguration {
  
  @0verride 
  public RequestMappingHandlerMapping createRequestMappingHandlerMapping() {
    return new ApiVersionRequestMappingHandlerMapping("");
  }
}</code></pre><p>Заметьте, что здесь создается новый класс: <code>ApiVersionRequestMappingHandlerMapping</code>. Какие действия здесь выполняет Spring Boot? Каждый раз, когда приходит входящий запрос, он пытается мапить его на метод. Приведенный выше код делает надстройку над этими мапингами. Заметьте, что вы можете ввести префикс, в данном случае мы используем префикс “<code>v</code>”. Если теперь запустить тесты, то два из четырех пройдут. </p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/6ae/b37/371/6aeb37371cabbe62c947e8b290b6d04c.png" height="1176" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/6ae/b37/371/6aeb37371cabbe62c947e8b290b6d04c.png" width="1280"/></figure><p>Эндпоинты <code>a1</code> и <code>b1</code> работают. Других у нас пока нет.</p><p>Чтобы ввести новые эндпоинты, добавляем код для <code>a2</code>. Получаем:</p><pre><code class="java">@RestController 
public class Controller {
  
  @GetVersionMapping(value ="/a", version = 1)
  public String a1() {
    return "al";
  }
  
  @GetVersionMapping(value ="/a", version = 2)
  public String a2() {
    return "a2";
  }
  
  @GetVersionMapping(value ="/b", version = 1)
  public String b1() {
    return "b1";
  }
}</code></pre><p>На этой стадии три из четырех тестов пройдут. Нам все еще надо реализовать версию 2 для эндпоинта <code>b</code>. Самое приятное здесь то, что можно использовать диапазоны, вот так: </p><pre><code class="java">@GetVersionMapping(value ="/b", version = {1, 2})
public String b1() {
  return "b1";
}</code></pre><p>И теперь, если мы прогоним тесты, мы получим четыре зеленых галочки. </p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/e93/4bf/655/e934bf6556efb563129d653126b26d81.png" height="1176" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e93/4bf/655/e934bf6556efb563129d653126b26d81.png" width="1280"/></figure><p>Давайте вернемся обратно к требованиям. </p><ul><li><p><strong>Единая версия для всех эндпоинтов.</strong> Все тесты прошли.  </p></li></ul><ul><li><p><strong>Минимум дополнительного кода.</strong> Мы поменяли одну аннотацию на другую: <code>@GetMapping</code> стало <code>@GetVersionMapping</code>; мы также разделили информацию об имени ресурса и версии, это довольно небольшие изменения, но самым большим изменением было добавление нового класса <code>WebMvcConfig</code>. Впрочем, это делается только один раз. То есть, если вы однажды добавили его в проект, вам больше не надо думать об этом, следовательно, здесь можно поставить зеленый кружок.  </p></li></ul><ul><li><p><strong>Добавление нового ресурса, версии или метода должно оказывать минимальное влияние на остальную кодовую базу</strong>. Например, мы добавили метод <code>a2</code> — это неизбежно, ведь внедряется новая функциональность. Однако пришлось внести изменения и в метод <code>b</code>, заменив версию 1 на {1, 2}. На первый взгляд, работа кажется небольшой, но представьте, что у нас 26 ресурсов — тогда изменения понадобились бы в 25 других эндпоинтах. Такой объем работы становится значительным, что подчеркивает важность минимизации влияния. Поэтому мы всё ещё на «оранжевом уровне».</p></li></ul><div><div class="table"><table><tbody><tr><td colspan="2"><p align="left">Требования к решению</p></td></tr><tr><td><p align="left">Единая версия для всех эндпоинтов.</p></td><td><p align="left">🟢</p></td></tr><tr><td><p align="left">Минимум дополнительного кода.</p></td><td><p align="left">🔴➡️🟢</p></td></tr><tr><td><p align="left">Минимальное влияние на кодовую базу.</p></td><td><p align="left">🟠</p></td></tr></tbody></table></div></div><p>Давайте посмотрим, можно ли исправить еще и это.</p><h3>Самое лучшее решение</h3><p>Итак, мы переходим к самому лучшему решению, добавить константу к тому, что у нас уже есть. Добавим константу <code>LATEST_VERSION</code>:</p><pre><code class="java">private static final int LATEST_VERSION = 2</code></pre><p>Теперь вставим ее в код мапинга для эндпоинта <code>b</code>: </p><pre><code class="java">@GetVersionMapping(value ="/b", version = {1, LATEST_VERSION})
public String b1() {
  return "b1";
}</code></pre><p>Все четыре теста проходят. </p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/752/b31/d1b/752b31d1bc3cb90ea5bd3c0ad288f118.png" height="1176" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/752/b31/d1b/752b31d1bc3cb90ea5bd3c0ad288f118.png" width="1280"/></figure><p>Осталось добавить новую версию, чтобы посмотреть, сколько изменений для этого придется произвести. </p><p>Добавим <code>a3</code></p><pre><code class="java">@RestController 
public class Controller {
  private static final int LATEST_VERSION = 3
    
  @GetVersionMapping(value ="/a", version = 1)
  public String a1() {
    return "al";
  }
  
  @GetVersionMapping(value ="/a", version = 2)
  public String a2() {
    return "a2";
  }
  
  @GetVersionMapping(value ="/a", version = LATEST_VERSION)
  public String a3() {
    return "a3";
  }
  
  @GetVersionMapping(value ="/b", version = {1, LATEST_VERSION})
  public String b1() {
    return "b1";
  }
}</code></pre><p><code>LATEST_VERSION</code><strong>, </strong>по понятным причинам, поменялась на 3. Итак, мы добавили метод <code>a3()</code> и обновили переменную <code>LATEST_VERSION</code>.</p><p>Давайте перейдем к тестам. Надо открыть и прогнать все шесть. Если все сделано правильно, все шесть галочек будут зелеными. </p><p>Так и есть.</p><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/41b/a4f/562/41ba4f562257f1cb4b7bb806f5cd519e.png" height="1176" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/41b/a4f/562/41ba4f562257f1cb4b7bb806f5cd519e.png" width="1280"/></figure><p>Перейдем к проверке требований.</p><ul><li><p><strong>Единая версия для всех эндпоинтов.</strong> Этот подход подтвердился на последних двух демонстрациях: версии 1, 2 и 3 успешно использовались для ресурсов <code>a</code> и <code>b</code>. Требование считается выполненным — зеленый статус.</p></li></ul><ul><li><p><strong>Минимум дополнительного кода.</strong> Этот пункт, как и ранее, полностью соответствует требованиям. Зеленый статус без изменений.</p></li></ul><ul><li><p><strong>Минимальное влияние на кодовую базу.</strong> Например, для ресурса <code>b</code> при добавлении метода <code>a3</code> единственным изменением стало увеличение значения константы <code>LATEST_VERSION</code>. Это изменение можно считать минимальным, что подтверждает зеленый статус и здесь.</p></li></ul><div><div class="table"><table><tbody><tr><td colspan="2"><p align="left">Требования к решению</p></td></tr><tr><td><p align="left">Единая версия для всех эндпоинтов.</p></td><td><p align="left">🟢</p></td></tr><tr><td><p align="left">Минимум дополнительного кода.</p></td><td><p align="left">🟢</p></td></tr><tr><td><p align="left">Минимальное влияние на кодовую базу.</p></td><td><p align="left">🟠➡️🟢</p></td></tr></tbody></table></div></div><h3>Одно дополнительное преимущество</h3><p>Система глобального версионирования эндпоинтов создана и работает, но хотелось бы упомянуть об одном дополнительном преимуществе, которое дает библиотека.  </p><p>Возьмем следующий пример:</p><p><code>/api/v1/resource</code></p><p>Эта строка состоит из трех частей:</p><ul><li><p>первая часть — это префикс (/api), который указывает на общий путь к API.</p></li><li><p>вторая часть (<code>v1</code>) обозначает версию API</p></li><li><p>третья часть (<code>resource</code>) — это имя конкретного ресурса, к которому осуществляется доступ.</p></li></ul><p>В Spring Boot вы можете отделить префикс. Вы можете поместить его на более высокий уровень. Но вы не можете отделить информацию по версии и имени ресурса в таком типе URL. И это кажется странным, не так ли? Это все равно как если бы вы поместили название улицы и номер дома в одно и то же поле. Мы все знаем, что это неправильно. Это разная информация, и она должна храниться в разных переменных. Но это невозможно в Spring Boot, он не позволяет разделять информацию по версии и ресурсу, по крайней мере, когда вы используете этот тип системы версионирования. </p><p>Библиотека делает такое разделение возможным. И, разделяя эти два типа информации, мы также можем изменить тип данных. То есть теперь имя ресурса все еще строка, но версия становится целым числом (<code>integer</code>). И тот факт, что версия стала <code>integer</code>, дает нам возможность использовать диапазоны версий. Теперь мы можем сказать, “дай мне версии от 1 до 100”, надо задать только два числа, и все, что между ними, будет заполнено автоматически. И эти диапазоны версий позволили с каждой созданной новой версией проделывать лишь очень малое количество дополнительной работы, чтобы все заработало для всех остальных эндпоинтов. Здорово, правда?</p><h3>Вывод</h3><p>Версионирование эндпоинтов может быть простым, когда вы используете глобальный номер версии. Решение, приведенное в конце статьи, весьма простое, и теперь потребителям проще отслеживать ваше версионирование URL. Им надо использовать только одно число. Все, что имеет этот номер версии, должно быть совместимо и работать одно с другим.</p><figure class="full-width"><img data-src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/725/c0c/ddb/725c0cddbe78ce9d7a9dd868c3632ad6.png" height="334" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/725/c0c/ddb/725c0cddbe78ce9d7a9dd868c3632ad6.png" width="1560"/></figure><p>Присоединяйтесь к русскоязычному сообществу разработчиков на Spring Boot в телеграм — <a href="https://t.me/+oBwACbkvJ19iODAy">Spring АйО</a>, чтобы быть в курсе последних новостей из мира разработки на Spring Boot и всего, что с ним связано.</p><p>Ждем всех, <a href="https://t.me/+oBwACbkvJ19iODAy">присоединяйтесь</a>!</p><p></p></div></div></div><!-- --><!-- --></div><!-- --><!-- --></div><!--]--><!-- --><div class="tm-article-presenter__meta" data-test-id="article-meta-links"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[java]"><span>java</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[kotlin]"><span>kotlin</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[api]"><span>api</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[web]"><span>web</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[versioning]"><span>versioning</span></a><!--]--></li><!--]--><!-- --></ul></div><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/companies/spring_aio/articles/"><!--[--><span>Блог компании Spring АйО</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/programming/"><!--[--><span>Программирование</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/java/"><!--[--><span>Java</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/kotlin/"><!--[--><span>Kotlin</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/api/"><!--[--><span>API</span><!--]--></a><!--]--></li><!--]--><!-- --></ul></div></div><!-- --><!--]--></article><!--]--></div><!-- --></div><div class="tm-article-sticky-panel" data-test-id="article-sticky-panel" style=""><div class="tm-data-icons tm-data-icons tm-data-icons_space-big tm-article-sticky-panel__icons" data-test-id="article-stats-icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article" height="24" width="24"><title>Всего голосов 13: ↑10 и ↓3</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-rating"></use></svg><span class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating tm-votes-meter__value" data-test-id="votes-meter-value" title="Всего голосов 13: ↑10 и ↓3">+8</span></div><!--teleport start--><!--teleport end--><!-- --></div><!-- --><!-- --><button class="bookmarks-button tm-data-icons__item" title="Добавить в закладки" type="button"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Добавить в закладки</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-favorite"></use></svg></span><span class="bookmarks-button__counter" title="Количество пользователей, добавивших публикацию в закладки">78</span></button><div class="tm-sharing tm-data-icons__item" title="Поделиться"><button class="tm-sharing__button" type="button"><svg class="tm-sharing__icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z" fill="currentColor"></path></svg></button><!--teleport start--><!--teleport end--></div><div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a class="tm-article-comments-counter-link__link" data-test-id="counter-comments" href="/ru/companies/spring_aio/articles/859910/comments/"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value">5</span><!--]--></a><!-- --></div><!--[--><!--[--><!--[--><!-- --><!--]--><!--]--><!--]--><!--teleport start--><!--teleport end--><!-- --></div></div></div><!--[--><!--]--><div class="tm-article-presenter__footer"><!--[--><!--[--><div class="tm-article-blocks"><!-- --><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><!-- --><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><!--[--><div class="tm-article-author" data-test-id="article-author-info"><!--[--><!--[--><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a class="tm-company-snippet__logo-link" href="/ru/companies/spring_aio/profile/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="40" src="//habrastorage.org/getpro/habr/company/8f1/91a/458/8f191a4584b8fab12d15af23e447a1d5.png" width="40"/></div></a><div class="tm-company-snippet__info"><a class="tm-company-snippet__title" data-test-id="company-title" href="/ru/companies/spring_aio/profile/"><span>Spring АйО</span></a><div class="tm-company-snippet__description">Компания</div></div></div><div class="tm-article-author__buttons"><!-- --><!-- --></div></div><div class="tm-article-author__company-contacts"><!--[--><a class="tm-article-author__contact" href="https://telegram.me/spring_aio" rel="noopener" target="_blank">Telegram</a><a class="tm-article-author__contact" href="https://www.springnow.ru" rel="noopener" target="_blank">Сайт</a><!--]--></div><div class="tm-article-author__separator"></div></div><!--]--><!--]--><div class="tm-user-card tm-user-card tm-user-card_variant-article tm-article-author__user-card" data-async-called="true"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a class="tm-user-card__userpic tm-user-card__userpic_size-40" href="/ru/users/spring_aio/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" src="//habrastorage.org/getpro/habr/avatars/8e0/5e8/a1c/8e05e8a1c5fd4560f661efb2cb00e77e.png"/></div></a><div class="tm-user-card__meta"><div class="tm-counter-container tm-karma tm-karma" title=" 85 голосов "><div class="tm-counter-container__header"><!--[--><div class="karma-display positive" data-v-7635202e="">45</div><!-- --><!--]--></div><div class="tm-counter-container__footer"><!--[--><div class="tm-karma__text">Карма</div><!--teleport start--><!--teleport end--><!--]--></div></div><div class="tm-counter-container" title="Рейтинг пользователя"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!-- --><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score_no-margin tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">105.9</span></span><!--]--></div><!-- --></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Рейтинг</span><!--]--></div></div></div></div></div><div class="tm-user-card__info tm-user-card__info_variant-article tm-user-card__info"><div class="tm-user-card__title tm-user-card__title_variant-article tm-user-card__title"><span class="tm-user-card__name tm-user-card__name_variant-article tm-user-card__name">Spring АйО</span><a class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article" href="/ru/users/spring_aio/"> @spring_aio</a><!-- --></div><p class="tm-user-card__short-info tm-user-card__short-info_variant-article tm-user-card__short-info" data-test-id="user-card-speciality">Главный по Spring</p></div></div><div class="tm-user-card__buttons tm-user-card__buttons_variant-article tm-user-card__buttons"><!-- --><div class="tm-user-card__button"><div class="tm-button-follow tm-user-card__button-follow"><!-- --><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div></div><!-- --><div class="tm-user-card__button tm-user-card__button_write" data-test-id="user-card-conversations"><svg class="tm-svg-img tm-user-card__button-icon" height="16" width="16"><title>Отправить сообщение</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#mail"></use></svg></div><!-- --></div><!-- --></div><!-- --></div><!--]--></div><!--]--><!-- --></section><!-- --><!--[--><!--]--><!--]--><div class="tm-article-blocks__comments"><div class="tm-article-page-comments" id="publication-comments"><div><!--[--><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style" data-test-id="counter-comments" href="/ru/companies/spring_aio/articles/859910/comments/"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментарии 5 </span><!--]--></a><!-- --></div><!--]--></div></div></div><!--[--><!--[--><!--]--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2><!--[--><!--]--></div><!-- --></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><!--[--><!--[--><div class="tm-tabs tm-tabs"><div class=""><!--[--><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim tm-tabs__tab-link">Лучшие за сутки</button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_slim tm-tabs__tab-link">Похожие</button></span><!--]--></div><!-- --></div><div class="similar-and-daily__tab-view"><div class="placeholder-wrapper"><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><div class="tm-placeholder-article-cards"><!--[--><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><!--]--></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div><!-- --></div><!--]--><!--]--></div><!--]--><!-- --></section><!--[--><!--]--><!-- --><!--[--><!--]--><!--]--></div><!--]--><!--]--></div></div><!--]--><!--]--></div></div><div class="tm-page__sidebar"><!--[--><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div><div class="tm-sexy-sidebar_initial tm-sexy-sidebar" style="margin-top:0px;"><!--[--><!--]--><!-- --><div class="tm-layout-sidebar__placeholder_initial"></div><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Информация</h2><!--[--><!--]--></div><!-- --></header><!--[--><div class="tm-block__body tm-block__body"><!--[--><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Сайт</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[--><a class="tm-company-basic-info__link" href="https://t.me/spring_aio" target="_blank">t.me</a><!--]--></dd></dl><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Дата регистрации</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[--><time datetime="2024-05-27T07:08:22.000Z" title="2024-05-27, 10:08">27  мая  2024</time><!--]--></dd></dl><!-- --><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Численность</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[-->11–30 человек<!--]--></dd></dl><!-- --><!-- --></div><!--]--></div><!--]--><!-- --></section><div class="tm-company-widgets"><!--[--><!--]--></div><!-- --><!-- --><!--]--><!-- --></div></div><!--]--></div></div><!-- --><!--]--></div></div></main><!-- --></div><div class="tm-footer-menu"><div class="tm-page-width"><!--[--><div class="tm-footer-menu__container"><!--[--><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Ваш аккаунт</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/companies/spring_aio/articles/859910/&amp;hl=ru" rel="nofollow" target="_self">Войти</a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/companies/spring_aio/articles/859910/&amp;hl=ru" rel="nofollow" target="_self">Регистрация</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Разделы</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/articles/">Статьи</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/news/">Новости</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/hubs/">Хабы</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/companies/">Компании</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/users/">Авторы</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/sandbox/">Песочница</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Информация</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/help/">Устройство сайта</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/authors/codex/">Для авторов</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/companies/corpblogs/">Для компаний</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/docs/transparency/">Документы</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement/?hl=ru_RU" target="_blank">Соглашение</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/?hl=ru_RU" target="_blank">Конфиденциальность</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Услуги</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">Корпоративный блог</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">Медийная реклама</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">Нативные проекты</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">Образовательные программы</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">Стартапам</a></li><!--]--></ul></div></div><!--]--></div><!--]--></div></div><div class="tm-footer"><div class="tm-page-width"><!--[--><div class="tm-footer__container"><!-- --><div class="tm-footer__social"><!--[--><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Facebook</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Twitter</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>VK</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Telegram</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Youtube</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Яндекс Дзен</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a><!--]--></div><!--teleport start--><!--teleport end--><button class="tm-footer__link"><!-- --> Настройка языка</button><a class="tm-footer__link" href="/ru/feedback/">Техническая поддержка</a><div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2025, </span><span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/" rel="noopener" target="_blank">Habr</a></span></span></div></div><!--]--></div></div><!-- --><!--]--></div><!-- --></div></div>
<div id="overlays"><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--></div>
</body>
</html>
