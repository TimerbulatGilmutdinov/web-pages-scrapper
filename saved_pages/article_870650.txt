<!DOCTYPE html>

<html lang="ru">
<head>
<title>Погружение в мир Lint'a в Android-проекте (часть 2) / Хабр</title>
</head>
<body>
<div id="mount"><div data-async-called="true" id="app"><div class="tm-layout__wrapper"><!--[--><!-- --><div></div><!-- --><header class="tm-header" data-test-id="header"><div class="tm-page-width"><!--[--><div class="tm-header__container"><!-- --><span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_hl-ru tm-header__logo" href="/ru/"><svg class="tm-svg-img tm-header__icon" height="16" width="16"><title>Хабр</title><use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a><span class="tm-header__beta-sign" style="display:none;">β</span></span><!--[--><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><!--[--><button class="tm-header__dropdown-toggle"><svg class="tm-svg-img tm-header__icon tm-header__icon_dropdown" height="16" width="16"><title>Открыть список</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#arrow-down"></use></svg></button><!--]--></div><!-- --></div><a class="tm-header__become-author-btn" href="/ru/sandbox/start/">Как стать автором</a><div class="tm-feature tm-feature tm-feature_variant-inline tm-header__feature"><!-- --></div><!-- --><!--]--><!-- --></div><!--]--></div></header><div class="tm-layout"><div class="tm-page-progress-bar"></div><div class="tm-base-layout__header_is-sticky tm-base-layout__header" data-menu-sticky="true"><div class="tm-page-width"><!--[--><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/feed/">Моя лента</a><!--]--><!--[--><a class="tm-main-menu__item" href="/ru/articles/">Все потоки</a><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/develop/">Разработка</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/admin/">Администрирование</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/design/">Дизайн</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/management/">Менеджмент</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/marketing/">Маркетинг</a><!--]--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/ru/flows/popsci/">Научпоп</a><!--]--><!--]--></nav></div></div><div class="tm-header-user-menu tm-base-layout__user-menu"><a class="tm-header-user-menu__item tm-header-user-menu__search" data-test-id="search-button" href="/ru/search/"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark" height="24" width="24"><title>Поиск</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#search"></use></svg></a><!-- --><!-- --><div class="tm-header-user-menu__item tm-header-user-menu__write"><div><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_write tm-header-user-menu__icon_dark" height="24" width="24"><title>Написать публикацию</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#write"></use></svg></div><!-- --></div><!--[--><div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="user-menu-settings"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark" height="24" width="24"><title>Настройки</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#page-settings"></use></svg></button></div><a class="tm-header-user-menu__item" href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/companies/domclick/articles/870650/&amp;hl=ru" rel="nofollow"><!--[--><button class="btn btn_solid btn_small tm-header-user-menu__login" type="button"><!--[-->Войти<!--]--></button><!--]--></a><!--]--><!-- --><!--teleport start--><!--teleport end--><!-- --></div></div><!--]--></div></div><!-- --><div class="tm-page-width"><!--[--><!--]--></div><main class="tm-layout__container"><div class="tm-page" companyname="domclick" data-async-called="true" hl="ru" style="--0c809c5a:16px;--a086013e:100%;--7c457026:0;"><div class="tm-page-width"><!--[--><div class="tm-page__header"><!--[--><!--]--></div><div class="tm-page__wrapper"><div class="tm-page__main_has-sidebar tm-page__main"><div class="pull-down"><!-- --><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__icon pull-down__arrow" height="24" width="24"><title>Обновить</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#pull-arrow"></use></svg></div></div><!--[--><!--[--><div class="tm-article-presenter"><!--[--><!--[--><!-- --><div class="tm-company-profile-card tm-company-article__profile-card"><div class="tm-company-card tm-company-profile-card__info"><div class="tm-company-card__header"><a class="tm-company-card__avatar" href="/ru/companies/domclick/profile/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="48" src="//habrastorage.org/getpro/habr/company/ae3/066/dff/ae3066dff6cb14bdced604d8d253d32b.png" width="48"/></div></a><!--[--><a class="tm-grade tm-company-card__rating" href="https://career.habr.com/companies/domclick" rel="noopener" target="_blank"><div class="tm-counter-container"><div class="tm-counter-container__header"><!--[--><!--[--><svg class="tm-svg-img tm-svg-grade__icon" height="18" width="18"><title>Оценка компании на Хабр Карьере</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#grade"></use></svg><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-grade"><!-- --><div class="tm-votes-lever__score tm-votes-lever__score_appearance-grade tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_grade tm-votes-lever__score-counter" data-test-id="votes-score-counter">4.71</span></span><!--]--></div><!-- --></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text_variant-grade tm-rating__text">Оценка</span><!--]--></div></div></a><div class="tm-counter-container tm-company-card__rating"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!-- --><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score_no-margin tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">206.18</span></span><!--]--></div><!-- --></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Рейтинг</span><!--]--></div></div><!-- --><!--]--></div><div class="tm-company-card__info"><a class="tm-company-card__name" href="/ru/companies/domclick/profile/"><span>Домклик</span></a><div class="tm-company-card__description">Место силы</div></div></div><div class="tm-company-profile-card__buttons"><div class="tm-button-follow tm-company-profile-card__button tm-company-profile-card__button_follow"><!-- --><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div><!-- --><!-- --><!-- --></div></div><!-- --><!--]--><!--]--><div class="tm-article-presenter__body" data-test-id="article-body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><!--[--><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><!--[--><div class="tm-article-presenter__header"><!--[--><!--]--><div class="tm-article-snippet tm-article-snippet tm-article-presenter__snippet"><!--[--><!--]--><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a class="tm-user-info__userpic" data-test-id="user-info-pic" href="/ru/users/exfaust/" title="exfaust"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" height="24" src="https://assets.habr.com/habr-web/img/avatars/169.png" width="24"/><!--]--></div></a><span class="tm-user-info__user tm-user-info__user_appearance-default" data-test-id="user-info-description"><a class="tm-user-info__username" href="/ru/users/exfaust/">exfaust <!-- --></a><!--[--><span class="tm-article-datetime-published"><time datetime="2025-01-21T07:56:30.000Z" title="2025-01-21, 10:56">21  янв   в 10:56</time></span><!--]--></span></span></div><!-- --></div><h1 class="tm-title tm-title_h1" data-test-id="articleTitle" lang="ru"><span>Погружение в мир Lint'a в Android-проекте (часть 2)</span></h1><div class="tm-article-snippet__stats" data-test-id="articleStats"><div class="tm-article-complexity tm-article-complexity_complexity-medium"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Уровень сложности</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#complexity-medium"></use></svg></span><span class="tm-article-complexity__label">Средний</span></div><div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Время на прочтение</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#clock"></use></svg></span><span class="tm-article-reading-time__label">10 мин</span></div><span class="tm-icon-counter tm-data-icons__item"><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Количество просмотров</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-views"></use></svg><span class="tm-icon-counter__value" title="1387">1.4K</span></span></div><div class="tm-publication-hubs__container" data-test-id="articleHubsList"><div class="tm-publication-hubs"><!--[--><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/companies/domclick/articles/"><!--[--><span>Блог компании Домклик</span><!-- --><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/android_dev/"><!--[--><span>Разработка под Android</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/kotlin/"><!--[--><span>Kotlin</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a class="tm-publication-hub__link" href="/ru/hubs/mobile_dev/"><!--[--><span>Разработка мобильных приложений</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><!--]--></div></div><div class="tm-article-labels" data-test-id="articleLabels"><div class="tm-article-labels__container"><div class="tm-publication-label tm-publication-label_variant-tutorial"><span>Туториал</span></div><!--[--><!--]--></div></div><!-- --><!-- --></div></div><!--[--><!-- --><div class="tm-article-body" data-gallery-root="" lang="ru"><div><!--[--><!--]--></div><div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>Продолжим рассматривать различные нюансы статического анализа с помощью Lint. Опираться будем на предыдущую <a href="https://habr.com/ru/companies/domclick/articles/818067/">статью</a>. С момента её публикации прошло много времени, за которое вышло несколько значимых обновлений Android Gradle Plugin (а с ним и всех артефактов линтера), а также вторая версия Kotlin с новым компилятором. Вкратце рассмотрим наиболее заметные для нас изменения с небольшими примерами. Кроме того, удалось найти что-то похожее на полноценную <a href="https://googlesamples.github.io/android-custom-lint-rules/api-guide.html">документацию</a> по lint (правда, редко обновляющуюся), наиболее интересные моменты оттуда тоже рассмотрим.</p><h2>Kotlin Analysis API</h2><p>Выход нового компилятора K2 всех встряхнул и заинтриговал, изменения коснулись и линта. Как известно, фронтенд компилятора служит для анализа семантики и синтаксиса исходного кода, который преобразуется в некоторое дерево с дополнительной метаинформацией и далее передаётся в бэкенд, где уже и собираются в нашем случае .class-файлы. Если коротко, в компиляторе K1 в бэкенд передаётся синтаксическое дерево вместе с BindingContext, описывающее семантику кода. В такой реализации были проблемы с производительностью, а также трудности в поддержке бекендов под разные таргеты (например, для JS). </p><p>В K2 подход изменили. Теперь задача фронтенда — преобразовать исходный в код в FIR (Frontend Intermediate Representation), то есть в некую структуру, описывающую и синтаксис, и семантику. Намеренно не буду углубляться, для нас тут достаточно понимать, что кроме AST и PSI будет ещё один инструмент/дерево для анализа.</p><figure class="full-width"><img alt="Структура компилятора K2 из блога Jetbrains" data-src="https://habrastorage.org/getpro/habr/upload_files/b55/a43/7df/b55a437df4c36f860c51510fb23a5b93.png" height="1080" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/b55/a43/7df/b55a437df4c36f860c51510fb23a5b93.png" title="Структура компилятора K2 из блога Jetbrains" width="1920"/><div><figcaption>Структура компилятора K2 из блога Jetbrains</figcaption></div></figure><p>Назвали этот инструмент <a href="https://kotlin.github.io/analysis-api/index_md.html">Kotlin Analysis API</a>. Информации о нём не слишком много, но резюмируя то, что есть, можно сразу констатировать несколько преимуществ:</p><ul><li><p>Основан на PSI, с которым существенно удобнее работать, чем с AST.</p></li><li><p>Поддерживается получение типа для PSI, сейчас это та ещё заморочка.</p></li><li><p>Не забыли про Any/Nothing/Unit и т. д., да и в целом API уже частично закрыт всевозможными простыми в использовании расширениями.</p></li><li><p>Работает, как и раньше, «из коробки», упомянуто также, что есть некоторая обратная совместимость с К1.</p></li></ul><p>Тема довольно обширная, на полноценную статью. Кроме того, разработчики упомянули, что некоторые части API временные или экспериментальные (в коде уже приличное количество Deprecated-аннотаций), то есть будут ещё доработки. Поэтому ограничимся только простенькими примерами.</p><p>Начнём с самого интересного — с типов в PSI. Есть у нас старый детектор, который проверяет, что во «View‑мире» при создании <code>ViewBinding</code><a href="https://developer.android.com/topic/libraries/view-binding#fragments"> в фрагментах</a> через свойства класса это свойство затем обнуляется. Так как разметка у нас может быть названа как угодно, мы не можем заложиться в проверке на имя (впрочем, это справедливо почти для любых проверок). То есть нам нужно убедиться, что свойство класса (ну или field в контексте Java и AST) имеет тип, унаследованный от <code>ViewBinding</code>. </p><p>Мы бы делали примерно так: </p><pre><code class="kotlin">property.toUElementOfType&lt;UField&gt;()
    ?.type
    ?.let { type -&gt;
          type.superTypes.find { it.canonicalText == "androidx.viewbinding.ViewBinding" } != null
    } == true</code></pre><p>Или можно вот так:</p><pre><code class="kotlin">TypeEvaluator.evaluate(context,property)
    .superTypes.any { it.canonicalText == "androidx.viewbinding.ViewBinding" }</code></pre><p> В Kotlin Analysis получилось примерно так:</p><pre><code class="kotlin">analyze(property){
    property.typeReference?.type?.allSupertypes?.any {
        it.symbol?.classId?.asFqNameString() == "androidx.viewbinding.ViewBinding"
    }
}</code></pre><p>Тут может показаться, что особой разницы нет, но это не так. Во‑первых, нет никакой гарантии, что любой узел дерева PSI сможет зарезолвиться в AST. Тот же field из примера не то же самое, что property (второй пример вообще будет возвращать null). Для некоторых конструкций Kotlin вообще нет аналога в AST, например, companion object, inline и т. д. Чтобы анализировать Kotlin, нужен PSI, а в нём нет типов. </p><p>Во‑вторых, нам предлагают полноценный API, который одинаковым образом будет использоваться для всех видов анализа. Раньше в каждой проверке мы индивидуально решали, как именно мы этот тип будем доставать. </p><p>Ну и наконец, этот API уже сейчас выглядит солидно, множество методов и расширений, позволяющих внутри блока <code>analyze</code> получить куда больше информации, чем требовалось в примере. Здесь же можно сразу убедиться, что тип «нулабельный» (<code>isMarkedNullable</code>), проверить модификаторы видимости (они не всегда доступны через PSI), аннотации и т. д. Но есть и более сложные штуки, например, одним вызовом получить всех наследников sealed‑интерфейса (с полной семантикой по каждому) или убедиться, что аргумент функции является интерфейсом.</p><p>Ключевая сущность в Kotlin Analysis — Symbol. Если коротко и упрощённо, то это некая абстракция узла дерева, которая и содержит в себе семантическую информацию, дополняя ею PSI. В примере выше полное имя класса получаем через свойство <code>classId</code> у symbol. Точкой входа служит блок <code>analyze</code> с <code>KaSession</code>. Предполагается, что вся работа с этим API будет только внутри блока, уносить куда‑то или сохранять <code>KaSession</code> противоречит контракту и приведёт к неправильной работе. Однако есть возможность создавать <code>KaSymbolPointer</code>, если нужно как‑то связать между собой два разных блока <code>analyze</code>.</p><h2>Тестирование</h2><h3>TestMode</h3><p>Где-то с год назад при написании тестов на детектор была распространена проблема, когда запускаешь тест, а он падает с непонятной ошибкой с предложением добавить какой-нибудь TestMode. После добавления оно и правда почему-то работало. После обновления Gradle-плагина эти ошибки получили довольно понятные, исчерпывающие описания. Как оказалось, за TestMode стоит целый дивный новый мир. </p><p>TestMode — это как бы режимы, в которых дополнительно к обычному прогону исполняются дополнительные тесты в различных вариациях. Они позволяют убедиться, что правило lint написано максимально корректно для всех возможных случаев написания кода. Например, есть у нас детектор, проверяющий правильность использования <code>Serializable</code>. Уже из названия непонятно, какой именно <code>Serializable</code> имеется в виду (<code>kotlinx.serialization.Serializable</code> или <code>java.io.Serializable</code>). Если в детекторе мы завяжемся просто на имя, то тест по умолчанию будет падать, так как умеет подменять импорты (то есть автоматически будут внесены изменения в код проверяемых классов и перезапущен тест). Также типы могут быть заменены на <code>typealias</code> или на <code>import alias</code>, добавлены ненужные полные пути, ненужные вызовы родительских классов, двойные пробелы, может быть изменён порядок именованных аргументов при вызове методов и т. д. В итоге тесты по умолчанию будут падать, если детектор не учитывает какой‑либо из этих режимов. Эти крайне полезные проверки заставляют думать наперёд и поменьше хардкодить. </p><figure class="full-width"><img alt="Пример ошибки из-за TestMode" data-src="https://habrastorage.org/getpro/habr/upload_files/eaa/8e8/637/eaa8e863786a8fbd3d7cbd4b3d202523.png" height="552" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/eaa/8e8/637/eaa8e863786a8fbd3d7cbd4b3d202523.png" title="Пример ошибки из-за TestMode" width="1160"/><div><figcaption>Пример ошибки из-за TestMode</figcaption></div></figure><p>Однако бывают случаи, когда делать это избыточно или неудобно (например, сразу после поднятия версии много тестов резко попадали), тогда можно какие-то режимы отключить через вызов <code>.skipTestModes(TestMode.WHITESPACE)</code>. Ну или наоборот, написать тест под конкретный режим через <code>addTestModes(TestMode.WHITESPACE)</code>. <a href="https://googlesamples.github.io/android-custom-lint-rules/api-guide.html#testmodes">Здесь</a> есть небольшое описание некоторых режимов, если по сообщению ошибки в тесте останутся вопросы.</p><h3>trimIndent</h3><p>При добавлении стабов и файлов для проверки в тестах мы использовали """ в студии, которая, в свою очередь, подставляла в конец <code>.trimIndent()</code>. Такой подход не <a href="https://googlesamples.github.io/android-custom-lint-rules/api-guide.html#lintcheckunittesting/trimmingindents?">рекомендуется</a>, предлагается убирать <code>trimIndent</code> в пользу <code>indented</code> у <code>TestFiles</code>. Если честно, мы не сталкивались с какими-то проблемами, а форматирование в самом сообщении об ошибке в тесте нас не особо беспокоит, но иметь в виду не помешает.</p><h3>composite lintFix</h3><p>Бывают случаи, когда нужно предоставить несколько альтернативных вариантов автоматически исправить найденную проблему через <code>lintFix</code>. Это делается через <code>fix().composite()</code>. Но есть нюанс: указанные здесь исправления в студии будут расположены в алфавитном порядке по имени, указанному в <code>.name()</code>, а не в порядке их следования в массиве. Чтобы избежать ошибок в тестах, лучше в <code>.composite()</code> сразу располагать исправления в алфавитном порядке.</p><h2>Частичный анализ</h2><p>У lint есть концепция, позволяющая настраивать автоматический пропуск правил по каким-то критериям, заранее заданным в детекторе. </p><p>Если повнимательнее рассмотреть методы <code>report</code> в <code>Context</code>, от которого наследуется  <code>JavaContext</code> , то можно увидеть любопытную сигнатуру <code>report(incident: Incident, constraint: Constraint)</code>. Чуть покопавшись, выясняем, что можно задавать какие-нибудь условия для работы наших проверок, в зависимости от свойств и настроек проекта или его окружения. Типичный пример: нет смысла запускать какую-нибудь проверку и показывать инспекцию для какой-то проблемы для 14-й версии SDK, если у вас <code>minSdkVersion = 16</code> (условно). Выглядеть такой отчёт в классе детектора будет примерно так: </p><pre><code class="kotlin">val constraint = minSdkAtLeast(14) and notLibraryProject()
context.report(Incident(ISSUE, node, context.getLocation(property), MESSAGE), constraint)</code></pre><p><code>Incident</code> здесь — это просто обёртка, в которую заворачиваются все параметры, что мы раньше передавали в report для <code>JavaContext</code> (там также есть билдер). В классе <code>Constraint</code> описано некоторое количество расширений, как в примере. К сожалению, этот класс sealed, что не позволяет нам удобно добавлять какие‑то свои ограничения, а тот небольшой имеющийся набор более актуален разработчикам SDK. </p><figure class="full-width"><img alt="Отключенные правила попали в отчёте в Disabled Checks" data-src="https://habrastorage.org/getpro/habr/upload_files/17e/c18/5a8/17ec185a8ad03df13e6426114b9cc909.png" height="508" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/17e/c18/5a8/17ec185a8ad03df13e6426114b9cc909.png" title="Отключенные правила попали в отчёте в Disabled Checks" width="1568"/><div><figcaption>Отключенные правила попали в отчёте в Disabled Checks</figcaption></div></figure><p>Однако, возможность исключать некоторые проверки всё же есть, для этого в классе детектора необходимо переопределить метод <code>filterIncident</code>. Просто проверяем какие‑то условия и возвращаем boolean. У этого метода в качестве аргумента есть специальная мапа — LintMap, она позволяет записать в методе <code>report</code> и использовать потом какие‑то значения (не рекомендуется использовать для этого сам класс детектора, так как его экземпляр всегда будет новый для других модулей или сборок). </p><p>Предположим, нам нужно проверять использование кастомных ресурсов в проекте (то есть они определены в фичёвом модуле, а не в модуле или библиотеке дизайн-системы). Загвоздка в том, что Gradle-модули у нас, как правило, изолированы от остального проекта в процессе анализа. Обычно нам это никак не мешает, если мы просто ищем ошибки в коде (наоборот, зачем нам анализировать весь большой проект, если мы работаем только в нашем модуле). С другой стороны, в нашем примере мы никак не сможем узнать, существует ли ссылка на ресурс, если он находится в другом модуле. В таком случае можно использовать связку <code>getPartialResults</code> и <code>checkPartialResults</code>. </p><pre><code class="kotlin">override fun afterCheckRootProject(context: Context) {
    context.getPartialResults(ISSUE).map().put("KEY", "serializedPaths")
}

override fun checkPartialResults(context: Context, partialResults: PartialResult) {
    partialResults
        .asSequence()
        .mapNotNull { (_, map) -&gt; map.getString("KEY", "") }
}</code></pre><p>Метод <code>getPartialResults</code> служит для записи и удержания вспомогательных данных для конкретного Issue, ну а в <code>checkPartialResults</code> (вызывается на этапе формирования отчёта) эти данные десериализуются из мапы. Мы могли бы пройтись и записать ссылки на доверенные ресурсы (из дизайн-системы), а затем проверить, существует ли у текущего ресурса такая ссылка в мапе. Таким образом, через механизм Partial можно собирать данные, относящиеся к разным модулям, а затем в конце, при публикации отчёта собрать эти данные, проверить и добавить ещё один дополнительный report в общий отчёт. У такого подхода есть очевидное ограничение: инспекции в студии работать не будут, так как для анализа в моменте будет нужен весь проект. Но это годится для проверок на CI при сборках для code review. По этой же схеме работает фича в студии по поиску неиспользуемых ресурсов. </p><h2>Data Flow Analyzer</h2><p>В <a href="https://googlesamples.github.io/android-custom-lint-rules/api-guide.html#dataflowanalyzer">документации</a> также описана ещё одна возможность для линтера, хотя и не часто используемая. С помощью <code>DataFlowAnalyzer</code> мы можем проверить, был ли вызов какого‑то узла (например, <code>UCallExpression</code>) для экземпляра какого‑либо класса. Типичный пример — это линт на старый добрый <code>toast</code>, когда все постоянно забывали писать в конце <code>show()</code>. Для этого предлагается использовать <code>TargetMethodDataFlowAnalyzer</code>:</p><pre><code class="kotlin">val targets = mapOf("show" to listOf("android.widget.Toast",
      "com.google.android.material.snackbar.Snackbar")
val analyzer = TargetMethodDataFlowAnalyzer.create(node, targets)
if (method.isMissingTarget(analyzer)) {
    context.report(...)
}</code></pre><p>В <code>DataFlowAnalyzer</code> скрывается большой пласт логики, но всё сводится к обычному поиску через паттерн visitor, что мы могли бы и сами сделать. Оба эти класса открытые и позволяют существенно переопределить логику, но вряд ли это будет нужно, наиболее интересные методы (для них даже отдельный класс выделен — <code>EscapeCheckingDataFlowAnalyzer</code>):</p><pre><code class="kotlin">var escaped: Boolean = false

override fun field(field: UElement) {
    escaped = true
}

override fun argument(call: UCallExpression, reference: UElement) {
    escaped = true
}

override fun returns(expression: UReturnExpression) {
    escaped = true
}

override fun array(array: UArrayAccessExpression) {
    escaped = true
}</code></pre><p>Как можно догадаться из названий, они служат для обработки случаев, когда экземпляр, на котором анализируется вызов метода, передаётся как аргумент, возвращается из другого метода и т. д. </p><p>В<code>TargetMethodDataFlowAnalyzer</code> ключевые методы — <code>isTargetMethodName</code> и <code>isTargetMethod</code>, где и сопоставляется вызов метода для <code>DataFlowAnalyzer</code>.</p><h2>Заключение</h2><p>Рассмотрели ещё несколько возможностей, которые нам предоставляет API линта для написания более сложных проверок более простыми (по мнению разработчиков из гугла) механизмами. Немного потрогали Kotlin Analysis API, выглядит многообещающе, но мы пока не форсируем переход на него, ждём стабилизации API. Остальные описанные функции могут показаться узконаправленными, но бывают задачи, которые по‑другому никак не сделать, или это очень сложно. </p><p>В качестве бонуса несколько заметок:</p><ul><li><p>В Google завели <a href="https://github.com/google/android-security-lints">репозиторий</a>, где пишут различные детекторы на тему <a href="https://developer.android.com/privacy-and-security/risks">безопасности</a>. Идея хорошая, но реализация нам показалась пока ещё сыроватой, а репозиторий — каким‑то учебным проектом. Там много неточностей, хардкода, неактуальная версия Gradle-плагина. Однако, какие‑то отдельные части брать можно и обустраивать для своих целей, либо подождать, пока владельцы доведут проект до ума. Кстати, там есть <code>UnsafeFilenameDetector</code>, где можно посмотреть пример использования <code>DataFlowAnalyzer</code> для методов класса <code>Cursor</code>.</p></li><li><p>Разбирая код из предыдущего пункта, заметили несколько любопытных вещей. Например, есть такой чудесный класс <code>SdkConstants</code>, в котором содержится огромное количество всевозможных констант, папки, пакеты классов SDK, атрибуты XML и много чего ещё. Сложно пользоваться, так как не знаешь, что там есть, но часть констант всё же полезна.</p></li><li><p>Как уже упоминалось ранее, в стандартном lint есть категория проблем с <code>Severity.Fatal</code>, для которых при невыполнении проверки будет падать релизная сборка. В дополнение к этому есть ещё такой <code>CommentDetector</code>, который проверяет в коде наличие комментария <code>//STOPSHIP</code> и тоже треггерит падение релизной сборки. Это может быть полезно, если вы разрабатываете какие‑нибудь debug tools и не хотите, чтобы они случайно попали в production.</p></li><li><p>У JetBrains есть отдельная <a href="https://plugins.jetbrains.com/docs/intellij/psi.html">страничка</a> про PSI, какие‑то вещи можно оттуда почерпнуть. Наиболее интересные, по нашему мнению, это про производительность в <a href="https://plugins.jetbrains.com/docs/intellij/psi-performance.html#avoid-expensive-methods-of-psielement">PSI</a> и <a href="https://plugins.jetbrains.com/docs/intellij/uast.html#uast-performance-hints">UAST</a> и <a href="https://plugins.jetbrains.com/docs/intellij/uast.html#uliteralexpression-should-not-be-used-for-strings">заметка</a> про литералы в разделе об UAST. </p></li><li><p>Помимо упомянутых ранее <code>JavaEvaluator</code> и <code>TypeEvaluator</code> в стандартных детекторах чаще всего встречается и <code>ConstantEvaluator</code>. В основном используется для быстрого получения значения или литерала какого‑либо узла (например, значение, присвоенное константе).</p></li><li><p>В какой‑то момент столкнулись с тем, что в <code>context.project.testSourceFolders</code> возвращались пустыми, хотя сами директории существуют. Перешли на <code>context.project.dir?.listFiles()</code>, где ищем тестовые директории вручную.</p></li></ul><p></p></div></div></div><!-- --><!-- --></div><!-- --><!-- --></div><!--]--><!-- --><div class="tm-article-presenter__meta" data-test-id="article-meta-links"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[android]"><span>android</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[lint]"><span>lint</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[kotlin]"><span>kotlin</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9+%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7]"><span>статистический анализ</span></a><!--]--></li><!--]--><!-- --></ul></div><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/companies/domclick/articles/"><!--[--><span>Блог компании Домклик</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/android_dev/"><!--[--><span>Разработка под Android</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/kotlin/"><!--[--><span>Kotlin</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a class="tm-hubs-list__link" href="/ru/hubs/mobile_dev/"><!--[--><span>Разработка мобильных приложений</span><!--]--></a><!--]--></li><!--]--><!-- --></ul></div></div><!-- --><!--]--></article><!--]--></div><!-- --></div><div class="tm-article-sticky-panel" data-test-id="article-sticky-panel" style=""><div class="tm-data-icons tm-data-icons tm-data-icons_space-big tm-article-sticky-panel__icons" data-test-id="article-stats-icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article" height="24" width="24"><title>Всего голосов 17: ↑17 и ↓0</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-rating"></use></svg><span class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating tm-votes-meter__value" data-test-id="votes-meter-value" title="Всего голосов 17: ↑17 и ↓0">+20</span></div><!--teleport start--><!--teleport end--><!-- --></div><!-- --><!-- --><button class="bookmarks-button tm-data-icons__item" title="Добавить в закладки" type="button"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Добавить в закладки</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-favorite"></use></svg></span><span class="bookmarks-button__counter" title="Количество пользователей, добавивших публикацию в закладки">19</span></button><div class="tm-sharing tm-data-icons__item" title="Поделиться"><button class="tm-sharing__button" type="button"><svg class="tm-sharing__icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z" fill="currentColor"></path></svg></button><!--teleport start--><!--teleport end--></div><div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a class="tm-article-comments-counter-link__link" data-test-id="counter-comments" href="/ru/companies/domclick/articles/870650/comments/"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value">9</span><!--]--></a><!-- --></div><!--[--><!--[--><!--[--><!-- --><!--]--><!--]--><!--]--><!--teleport start--><!--teleport end--><!-- --></div></div></div><!--[--><!--]--><div class="tm-article-presenter__footer"><!--[--><!--[--><div class="tm-article-blocks"><!-- --><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><!-- --><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><!--[--><div class="tm-article-author" data-test-id="article-author-info"><!--[--><!--[--><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a class="tm-company-snippet__logo-link" href="/ru/companies/domclick/profile/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="40" src="//habrastorage.org/getpro/habr/company/ae3/066/dff/ae3066dff6cb14bdced604d8d253d32b.png" width="40"/></div></a><div class="tm-company-snippet__info"><a class="tm-company-snippet__title" data-test-id="company-title" href="/ru/companies/domclick/profile/"><span>Домклик</span></a><div class="tm-company-snippet__description">Место силы</div></div></div><div class="tm-article-author__buttons"><!-- --><!-- --></div></div><div class="tm-article-author__company-contacts"><!--[--><a class="tm-article-author__contact" href="https://career.domclick.ru/" rel="noopener" target="_blank">Сайт</a><!--]--></div><div class="tm-article-author__separator"></div></div><!--]--><!--]--><div class="tm-user-card tm-user-card tm-user-card_variant-article tm-article-author__user-card" data-async-called="true"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a class="tm-user-card__userpic tm-user-card__userpic_size-40" href="/ru/users/exfaust/"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" src="https://assets.habr.com/habr-web/img/avatars/169.png"/><!--]--></div></a><div class="tm-user-card__meta"><div class="tm-counter-container tm-karma tm-karma" title=" 15 голосов "><div class="tm-counter-container__header"><!--[--><div class="karma-display positive" data-v-7635202e="">13</div><!-- --><!--]--></div><div class="tm-counter-container__footer"><!--[--><div class="tm-karma__text">Карма</div><!--teleport start--><!--teleport end--><!--]--></div></div><div class="tm-counter-container" title="Рейтинг пользователя"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!-- --><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">20</span></span><!--]--></div><!-- --></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Рейтинг</span><!--]--></div></div></div></div></div><div class="tm-user-card__info tm-user-card__info_variant-article tm-user-card__info"><div class="tm-user-card__title tm-user-card__title_variant-article tm-user-card__title"><span class="tm-user-card__name tm-user-card__name_variant-article tm-user-card__name">Жадов Алексей</span><a class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article" href="/ru/users/exfaust/"> @exfaust</a><!-- --></div><p class="tm-user-card__short-info tm-user-card__short-info_variant-article tm-user-card__short-info" data-test-id="user-card-speciality">Пользователь</p></div></div><div class="tm-user-card__buttons tm-user-card__buttons_variant-article tm-user-card__buttons"><!-- --><div class="tm-user-card__button"><div class="tm-button-follow tm-user-card__button-follow"><!-- --><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div></div><!-- --><div class="tm-user-card__button tm-user-card__button_write" data-test-id="user-card-conversations"><svg class="tm-svg-img tm-user-card__button-icon" height="16" width="16"><title>Отправить сообщение</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#mail"></use></svg></div><!-- --></div><!-- --></div><!-- --></div><!--]--></div><!--]--><!-- --></section><!-- --><!--[--><!--]--><!--]--><div class="tm-article-blocks__comments"><div class="tm-article-page-comments" id="publication-comments"><div><!--[--><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style" data-test-id="counter-comments" href="/ru/companies/domclick/articles/870650/comments/"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментарии 9 </span><!--]--></a><!-- --></div><!--]--></div></div></div><!--[--><!--[--><!--]--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2><!--[--><!--]--></div><!-- --></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><!--[--><!--[--><div class="tm-tabs tm-tabs"><div class=""><!--[--><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim tm-tabs__tab-link">Лучшие за сутки</button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_slim tm-tabs__tab-link">Похожие</button></span><!--]--></div><!-- --></div><div class="similar-and-daily__tab-view"><div class="placeholder-wrapper"><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><div class="tm-placeholder-article-cards"><!--[--><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><!--]--></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div><!-- --></div><!--]--><!--]--></div><!--]--><!-- --></section><!--[--><!--[--><div class="placeholder-wrapper"><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><div class="tm-placeholder-inset tm-placeholder-vacancies"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div><div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><!--[--><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><!--]--></ul></div><div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div><!--]--><!--]--><!-- --><!--[--><!--]--><!--]--></div><!--]--><!--]--></div></div><!--]--><!--]--></div></div><div class="tm-page__sidebar"><!--[--><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div><div class="tm-sexy-sidebar_initial tm-sexy-sidebar" style="margin-top:0px;"><!--[--><!--]--><!-- --><div class="tm-layout-sidebar__placeholder_initial"></div><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Информация</h2><!--[--><!--]--></div><!-- --></header><!--[--><div class="tm-block__body tm-block__body"><!--[--><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Сайт</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[--><a class="tm-company-basic-info__link" href="https://domclick.ru/" target="_blank">domclick.ru</a><!--]--></dd></dl><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Дата регистрации</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[--><time datetime="2020-03-17T09:21:32.000Z" title="2020-03-17, 12:21">17  марта  2020</time><!--]--></dd></dl><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Дата основания</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[--><time datetime="2015-07-18T21:00:00.000Z" title="2015-07-19, 00:00">19  июля  2015</time><!--]--></dd></dl><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Численность</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[-->501–1 000 человек<!--]--></dd></dl><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Местоположение</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[-->Россия<!--]--></dd></dl><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap tm-description-list__title">Представитель</dt><dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap tm-description-list__body"><!--[--><a class="tm-company-basic-info__link" href="/ru/users/Dangorche/">Dangorche</a><!--]--></dd></dl></div><!--]--></div><!--]--><!-- --></section><div class="tm-company-widgets"><!--[--><!--]--></div><!-- --><!-- --><!--]--><!-- --></div></div><!--]--></div></div><!-- --><!--]--></div></div></main><!-- --></div><div class="tm-footer-menu"><div class="tm-page-width"><!--[--><div class="tm-footer-menu__container"><!--[--><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Ваш аккаунт</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/companies/domclick/articles/870650/&amp;hl=ru" rel="nofollow" target="_self">Войти</a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/companies/domclick/articles/870650/&amp;hl=ru" rel="nofollow" target="_self">Регистрация</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Разделы</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/articles/">Статьи</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/news/">Новости</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/hubs/">Хабы</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/companies/">Компании</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/users/">Авторы</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/sandbox/">Песочница</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Информация</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/help/">Устройство сайта</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/authors/codex/">Для авторов</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/companies/corpblogs/">Для компаний</a></li><li class="tm-footer-menu__list-item"><a class="footer-menu__item-link" href="/ru/docs/docs/transparency/">Документы</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement/?hl=ru_RU" target="_blank">Соглашение</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/?hl=ru_RU" target="_blank">Конфиденциальность</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Услуги</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">Корпоративный блог</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">Медийная реклама</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">Нативные проекты</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">Образовательные программы</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">Стартапам</a></li><!--]--></ul></div></div><!--]--></div><!--]--></div></div><div class="tm-footer"><div class="tm-page-width"><!--[--><div class="tm-footer__container"><!-- --><div class="tm-footer__social"><!--[--><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Facebook</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Twitter</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>VK</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Telegram</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Youtube</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Яндекс Дзен</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a><!--]--></div><!--teleport start--><!--teleport end--><button class="tm-footer__link"><!-- --> Настройка языка</button><a class="tm-footer__link" href="/ru/feedback/">Техническая поддержка</a><div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2025, </span><span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/" rel="noopener" target="_blank">Habr</a></span></span></div></div><!--]--></div></div><!-- --><!--]--></div><!-- --></div></div>
<div id="overlays"><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--><!-- --><!--teleport anchor--></div>
</body>
</html>
